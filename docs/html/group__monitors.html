<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Embedded Xinu Operating System: Monitors</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded Xinu Operating System
   </div>
   <div id="projectbrief">An ongoing research project and educational operating system.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Monitors<div class="ingroups"><a class="el" href="group__system.html">System Calls</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Monitor creation, locking, unlocking, and freeing.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga890b5cddd6552af757ba83df0d98411f"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__monitors.html#ga890b5cddd6552af757ba83df0d98411f">lock</a> (monitor mon)</td></tr>
<tr class="separator:ga890b5cddd6552af757ba83df0d98411f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1468f65ae8caff736b49bfadda072306"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__monitors.html#ga1468f65ae8caff736b49bfadda072306">moncount</a> (monitor mon)</td></tr>
<tr class="separator:ga1468f65ae8caff736b49bfadda072306"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga847945847782446b422b90615a2d04eb"><td class="memItemLeft" align="right" valign="top">monitor&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__monitors.html#ga847945847782446b422b90615a2d04eb">moncreate</a> (void)</td></tr>
<tr class="separator:ga847945847782446b422b90615a2d04eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf0f342ddccbef6e4195e3314bf3847e0"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__monitors.html#gaf0f342ddccbef6e4195e3314bf3847e0">monfree</a> (monitor mon)</td></tr>
<tr class="separator:gaf0f342ddccbef6e4195e3314bf3847e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga298f8477f3e145fe2402e9b00be084cf"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__monitors.html#ga298f8477f3e145fe2402e9b00be084cf">unlock</a> (monitor mon)</td></tr>
<tr class="separator:ga298f8477f3e145fe2402e9b00be084cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Monitor creation, locking, unlocking, and freeing. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga890b5cddd6552af757ba83df0d98411f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall lock </td>
          <td>(</td>
          <td class="paramtype">monitor&#160;</td>
          <td class="paramname"><em>mon</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Lock a monitor.</p>
<p>If no thread owns the monitor, its owner is set to the current thread and its count is set to 1.</p>
<p>If the current thread already owns the monitor, its count is incremented and no further action is taken.</p>
<p>If another thread owns the monitor, the current thread waits for the monitor to become fully unlocked by that thread, then sets its owner to the current thread and its count to 1.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mon</td><td>The monitor to lock.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success; ::SYSERR on failure (<code>mon</code> did not specify a valid, allocated monitor). </dd></dl>

</div>
</div>
<a class="anchor" id="ga1468f65ae8caff736b49bfadda072306"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall moncount </td>
          <td>(</td>
          <td class="paramtype">monitor&#160;</td>
          <td class="paramname"><em>mon</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve the count of a monitor &mdash; that is, the number of times it has been locked by the owning thread, or 0 if no thread currently owns the monitor.</p>
<p>This function performs no locking. The caller must temporarily disable interrupts if the specified monitor could potentially be freed, locked, or unlocked concurrently.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mon</td><td>The monitor to retrieve the count of.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If <code>mon</code> specified a valid, allocated monitor, its count is returned. Otherwise, ::SYSERR is returned. </dd></dl>

</div>
</div>
<a class="anchor" id="ga847945847782446b422b90615a2d04eb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">monitor moncreate </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and initialize a new monitor.</p>
<dl class="section return"><dt>Returns</dt><dd>On success, returns the new monitor. On failure (system is out of monitors or semaphores), returns ::SYSERR. </dd></dl>

</div>
</div>
<a class="anchor" id="gaf0f342ddccbef6e4195e3314bf3847e0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall monfree </td>
          <td>(</td>
          <td class="paramtype">monitor&#160;</td>
          <td class="paramname"><em>mon</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Free a monitor previously allocated with <a class="el" href="group__monitors.html#ga847945847782446b422b90615a2d04eb">moncreate()</a>.</p>
<p>A monitor must only be freed when no thread has it locked &ndash; that is, either the monitor is unowned, or is owned by a thread that has been killed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mon</td><td>The monitor to free.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success; ::SYSERR on failure (<code>mon</code> did not specify a valid, allocated monitor). </dd></dl>

</div>
</div>
<a class="anchor" id="ga298f8477f3e145fe2402e9b00be084cf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall unlock </td>
          <td>(</td>
          <td class="paramtype">monitor&#160;</td>
          <td class="paramname"><em>mon</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Unlock a monitor.</p>
<p>The monitor's lock count (indicating the number of times the owning thread has locked the monitor) is decremented. If the count remains greater than zero, no further action is taken. If the count reaches zero, the monitor is set to unowned and up to one thread that may be waiting to <a class="el" href="group__monitors.html#ga890b5cddd6552af757ba83df0d98411f">lock()</a> the monitor is awakened.</p>
<p>This normally should be called by the owning thread of the monitor subsequently to a <a class="el" href="group__monitors.html#ga890b5cddd6552af757ba83df0d98411f">lock()</a> by the same thread, but this also may be called moncount(mon) times to fully unlock a monitor that was owned by a thread that has been killed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mon</td><td>The monitor to unlock.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success; ::SYSERR on failure (<code>mon</code> did not specify a valid, allocated monitor with nonzero lock count). </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
