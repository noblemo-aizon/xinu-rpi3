<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Embedded Xinu Operating System: UDP internals</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded Xinu Operating System
   </div>
   <div id="projectbrief">An ongoing research project and educational operating system.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">UDP internals<div class="ingroups"><a class="el" href="group__udp.html">UDP</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Low-level functions mostly internal to the UDP driver.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabf6402d0f7579e36434eb894d62f4cd9"><td class="memItemLeft" align="right" valign="top">ushort&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpinternal.html#gabf6402d0f7579e36434eb894d62f4cd9">udpChksum</a> (struct packet *pkt, ushort len, const struct netaddr *src, const struct netaddr *dst)</td></tr>
<tr class="separator:gabf6402d0f7579e36434eb894d62f4cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaabaf725b5bfd5ce49a08a8c9905dab1d"><td class="memItemLeft" align="right" valign="top">struct udp *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpinternal.html#gaabaf725b5bfd5ce49a08a8c9905dab1d">udpDemux</a> (ushort dstpt, ushort srcpt, const struct netaddr *dstip, const struct netaddr *srcip)</td></tr>
<tr class="separator:gaabaf725b5bfd5ce49a08a8c9905dab1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2a360f56afbbc2f63b2a88efe93d117a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga2a360f56afbbc2f63b2a88efe93d117a"></a>
syscall&#160;</td><td class="memItemRight" valign="bottom"><b>udpFreebuf</b> (struct udpPkt *udppkt)</td></tr>
<tr class="separator:ga2a360f56afbbc2f63b2a88efe93d117a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga68d45236b38c1e1cc88f0ea498f14675"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ga68d45236b38c1e1cc88f0ea498f14675"></a>
struct udpPkt *&#160;</td><td class="memItemRight" valign="bottom"><b>udpGetbuf</b> (struct udp *udpptr)</td></tr>
<tr class="separator:ga68d45236b38c1e1cc88f0ea498f14675"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf90c7ded7bff66c36e5d633f009aa7c4"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpinternal.html#gaf90c7ded7bff66c36e5d633f009aa7c4">udpRecv</a> (struct packet *pkt, const struct netaddr *src, const struct netaddr *dst)</td></tr>
<tr class="separator:gaf90c7ded7bff66c36e5d633f009aa7c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22c9e2434d8ea5cae12ca55c82e4d3a3"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpinternal.html#ga22c9e2434d8ea5cae12ca55c82e4d3a3">udpSend</a> (struct udp *udpptr, ushort datalen, const void *buf)</td></tr>
<tr class="separator:ga22c9e2434d8ea5cae12ca55c82e4d3a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Low-level functions mostly internal to the UDP driver. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gabf6402d0f7579e36434eb894d62f4cd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ushort udpChksum </td>
          <td>(</td>
          <td class="paramtype">struct packet *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname"><em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the checksum of a UDP packet based on UDP and IP information </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">udppkt</td><td>UDP packet to calculate checksum for </td></tr>
    <tr><td class="paramname">len</td><td>Length of UDP packet </td></tr>
    <tr><td class="paramname">src</td><td>Source IP Address </td></tr>
    <tr><td class="paramname">dst</td><td>Destination IP Address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The checksum of the UDP packet </dd></dl>

</div>
</div>
<a class="anchor" id="gaabaf725b5bfd5ce49a08a8c9905dab1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct udp* udpDemux </td>
          <td>(</td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname"><em>dstpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname"><em>srcpt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>dstip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>srcip</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Locate the UDP socket for a UDP packet </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dstpt</td><td>destination port of the UDP packet </td></tr>
    <tr><td class="paramname">srcpt</td><td>source port of the UDP packet </td></tr>
    <tr><td class="paramname">dstip</td><td>destination IP of the UDP packet </td></tr>
    <tr><td class="paramname">srcip</td><td>source IP of the UDP packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>most completely matched socket, NULL if no match </dd></dl>
<dl class="section pre"><dt>Precondition</dt><dd>-condition interrupts are already disabled </dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>-condition interrupts are still disabled </dd></dl>

</div>
</div>
<a class="anchor" id="gaf90c7ded7bff66c36e5d633f009aa7c4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall udpRecv </td>
          <td>(</td>
          <td class="paramtype">struct packet *&#160;</td>
          <td class="paramname"><em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>src</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct netaddr *&#160;</td>
          <td class="paramname"><em>dst</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Receive a UDP packet and place it in the UDP device's input buffer </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pkt</td><td>Incoming UDP packet </td></tr>
    <tr><td class="paramname">src</td><td>Source address </td></tr>
    <tr><td class="paramname">dst</td><td>Destination address </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK if UDP packet is received properly, otherwise SYSERR </dd></dl>

</div>
</div>
<a class="anchor" id="ga22c9e2434d8ea5cae12ca55c82e4d3a3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall udpSend </td>
          <td>(</td>
          <td class="paramtype">struct udp *&#160;</td>
          <td class="paramname"><em>udpptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ushort&#160;</td>
          <td class="paramname"><em>datalen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Send a UDP packet through a UDP device, thereby sending it over the network with the address/port parameters with which the UDP device is configured.</p>
<p>This function is intended to be internal to the UDP code. From external code use <a class="el" href="group__devcalls.html#ga400d1061c614113f32fc30ce80c85a98">write()</a>, which calls <a class="el" href="group__udpexternal.html#gaf42df1179176ea560a6101b7741cfe1d">udpWrite()</a>.</p>
<p>Note: depending on the lower levels of the network stack, this function likely only buffers the packet to be sent at some later time. Therefore, it may not have actually been transmitted on the wire when this function returns.</p>
<p>The UDP device MUST be open and MUST remain open throughout the execution of this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">udpptr</td><td>Pointer to the control block for the UDP device. </td></tr>
    <tr><td class="paramname">datalen</td><td>Number of bytes of data to send, which must be a valid value for the current UDP device mode (e.g. if in passive mode, it must be at least the length of the UDP pseudo-header plus UDP header). </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data to send. In the default mode, this will interpreted as the UDP payload; however, if the UDP device is in passive mode, this will interpreted as the UDP pseudo-header follewed by the UDP header followed by the UDP payload.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK if packet was sent successfully; otherwise SYSERR or an error code returned by <a class="el" href="group__ipv4.html#ga1b9759ea210530fd31b6d1e7febdc7a0">ipv4Send()</a>. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
