<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Embedded Xinu Operating System: Semaphores</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded Xinu Operating System
   </div>
   <div id="projectbrief">An ongoing research project and educational operating system.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Semaphores<div class="ingroups"><a class="el" href="group__system.html">System Calls</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Semaphore creation, waiting, signaling, and freeing.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga7353c66e82358853d0238e51219fd21d"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#ga7353c66e82358853d0238e51219fd21d">semcount</a> (semaphore sem)</td></tr>
<tr class="separator:ga7353c66e82358853d0238e51219fd21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf089bbb787625a42d499d88682ae25e4"><td class="memItemLeft" align="right" valign="top">semaphore&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#gaf089bbb787625a42d499d88682ae25e4">semcreate</a> (int count)</td></tr>
<tr class="separator:gaf089bbb787625a42d499d88682ae25e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga084394f443d9d10f8a77b31826612fa9"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#ga084394f443d9d10f8a77b31826612fa9">semfree</a> (semaphore sem)</td></tr>
<tr class="separator:ga084394f443d9d10f8a77b31826612fa9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaabc21774105aef3974d6a4dcb0fe1387"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#gaabc21774105aef3974d6a4dcb0fe1387">signal</a> (semaphore sem)</td></tr>
<tr class="separator:gaabc21774105aef3974d6a4dcb0fe1387"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadb3860be8fffb140e38eba0638c88188"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#gadb3860be8fffb140e38eba0638c88188">signaln</a> (semaphore sem, int count)</td></tr>
<tr class="separator:gadb3860be8fffb140e38eba0638c88188"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gafdb60e3fbb4db9eceeaaa03bca2a261b"><td class="memItemLeft" align="right" valign="top">syscall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__semaphores.html#gafdb60e3fbb4db9eceeaaa03bca2a261b">wait</a> (semaphore sem)</td></tr>
<tr class="separator:gafdb60e3fbb4db9eceeaaa03bca2a261b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Semaphore creation, waiting, signaling, and freeing. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga7353c66e82358853d0238e51219fd21d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall semcount </td>
          <td>(</td>
          <td class="paramtype">semaphore&#160;</td>
          <td class="paramname"><em>sem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Retrieve a semaphore's count.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sem</td><td>Semaphore to get the count of.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns the semaphore's count; otherwise returns ::SYSERR. This function can only fail if <code>sem</code> did not specify a valid semaphore. </dd></dl>

</div>
</div>
<a class="anchor" id="gaf089bbb787625a42d499d88682ae25e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">semaphore semcreate </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a semaphore that initially has the specified count.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">count</td><td>Initial count of the semaphore (often the number of some resource that is available). Must be non-negative.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns the new semaphore; otherwise returns ::SYSERR. The new semaphore must be freed with <a class="el" href="group__semaphores.html#ga084394f443d9d10f8a77b31826612fa9">semfree()</a> when no longer needed. This function can only fail if the system is out of semaphores or if <code>count</code> was negative. </dd></dl>

</div>
</div>
<a class="anchor" id="ga084394f443d9d10f8a77b31826612fa9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall semfree </td>
          <td>(</td>
          <td class="paramtype">semaphore&#160;</td>
          <td class="paramname"><em>sem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Frees a semaphore. This can be done even if threads are waiting on it, in which case they will be released and able to run. However, be careful, since such threads will return from <a class="el" href="group__semaphores.html#gafdb60e3fbb4db9eceeaaa03bca2a261b">wait()</a>ing on a semaphore that no longer exists and there may be assumptions that no longer hold.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sem</td><td>Semaphore to free (allocated by <a class="el" href="group__semaphores.html#gaf089bbb787625a42d499d88682ae25e4">semcreate()</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::SYSERR if <code>sem</code> did not specify a valid semaphore; otherwise ::OK. </dd></dl>

</div>
</div>
<a class="anchor" id="gaabc21774105aef3974d6a4dcb0fe1387"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall signal </td>
          <td>(</td>
          <td class="paramtype">semaphore&#160;</td>
          <td class="paramname"><em>sem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Signal a semaphore, releasing up to one waiting thread.</p>
<p><a class="el" href="group__semaphores.html#gaabc21774105aef3974d6a4dcb0fe1387">signal()</a> may reschedule the currently running thread. As a result, <a class="el" href="group__semaphores.html#gaabc21774105aef3974d6a4dcb0fe1387">signal()</a> should not be called from non-reentrant interrupt handlers unless ::resdefer is set to a positive value at the start of the interrupt handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sem</td><td>Semaphore to signal.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success, ::SYSERR on failure. This function can only fail if <code>sem</code> did not specify a valid semaphore. </dd></dl>

</div>
</div>
<a class="anchor" id="gadb3860be8fffb140e38eba0638c88188"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall signaln </td>
          <td>(</td>
          <td class="paramtype">semaphore&#160;</td>
          <td class="paramname"><em>sem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>count</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Signal a semaphore <code>count</code> times, releasing <code>count</code> waiting threads.</p>
<p><a class="el" href="group__semaphores.html#gadb3860be8fffb140e38eba0638c88188">signaln()</a> may reschedule the currently running thread. As a result, <a class="el" href="group__semaphores.html#gadb3860be8fffb140e38eba0638c88188">signaln()</a> should not be called from non-reentrant interrupt handlers unless ::resdefer is set to a positive value at the start of the interrupt handler.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sem</td><td>Semaphore to signal. </td></tr>
    <tr><td class="paramname">count</td><td>Number of times to signal, which must be positive.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success, ::SYSERR on failure. This function can only fail if <code>sem</code> did not specify a valid semaphore of if <code>count</code> was not positive. </dd></dl>

</div>
</div>
<a class="anchor" id="gafdb60e3fbb4db9eceeaaa03bca2a261b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">syscall wait </td>
          <td>(</td>
          <td class="paramtype">semaphore&#160;</td>
          <td class="paramname"><em>sem</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Wait on a semaphore.</p>
<p>If the semaphore's count is positive, it will be decremented and this function will return immediately. Otherwise, the currently running thread will be put to sleep until the semaphore is signaled with <a class="el" href="group__semaphores.html#gaabc21774105aef3974d6a4dcb0fe1387">signal()</a> or <a class="el" href="group__semaphores.html#gadb3860be8fffb140e38eba0638c88188">signaln()</a>, or freed with <a class="el" href="group__semaphores.html#ga084394f443d9d10f8a77b31826612fa9">semfree()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sem</td><td>Semaphore to wait on.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK on success; ::SYSERR on failure. This function can only fail if <code>sem</code> did not specify a valid semaphore. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
