<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>Embedded Xinu Operating System: UDP standard functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Embedded Xinu Operating System
   </div>
   <div id="projectbrief">An ongoing research project and educational operating system.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">UDP standard functions<div class="ingroups"><a class="el" href="group__udp.html">UDP</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Primary UDP API, including functions compliant with Xinu's device model.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabcbf39c9ecabbf6066fff987c50c7db1"><td class="memItemLeft" align="right" valign="top">ushort&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#gabcbf39c9ecabbf6066fff987c50c7db1">udpAlloc</a> (void)</td></tr>
<tr class="separator:gabcbf39c9ecabbf6066fff987c50c7db1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b9a2995c6470acb368863cb0c467921"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#ga4b9a2995c6470acb368863cb0c467921">udpClose</a> (device *devptr)</td></tr>
<tr class="separator:ga4b9a2995c6470acb368863cb0c467921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga19a687321da86a127c08eb51ed7d3b0a"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#ga19a687321da86a127c08eb51ed7d3b0a">udpControl</a> (device *devptr, int func, long arg1, long arg2)</td></tr>
<tr class="separator:ga19a687321da86a127c08eb51ed7d3b0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae5b3e1ee3e3d286f70482aa26831af45"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#gae5b3e1ee3e3d286f70482aa26831af45">udpInit</a> (device *devptr)</td></tr>
<tr class="separator:gae5b3e1ee3e3d286f70482aa26831af45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga145b34934ec681c09c5d32083c7f769d"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#ga145b34934ec681c09c5d32083c7f769d">udpOpen</a> (device *devptr, va_list ap)</td></tr>
<tr class="separator:ga145b34934ec681c09c5d32083c7f769d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadab18aa82e8854f5a53051ab0ed2c665"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#gadab18aa82e8854f5a53051ab0ed2c665">udpRead</a> (device *devptr, void *buf, uint len)</td></tr>
<tr class="separator:gadab18aa82e8854f5a53051ab0ed2c665"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf42df1179176ea560a6101b7741cfe1d"><td class="memItemLeft" align="right" valign="top">devcall&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__udpexternal.html#gaf42df1179176ea560a6101b7741cfe1d">udpWrite</a> (device *devptr, const void *buf, uint len)</td></tr>
<tr class="separator:gaf42df1179176ea560a6101b7741cfe1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Primary UDP API, including functions compliant with Xinu's device model. </p>
<p>Users should use <a class="el" href="group__udpexternal.html#gabcbf39c9ecabbf6066fff987c50c7db1">udpAlloc()</a> to allocate a UDP device, then use the generic device calls <a class="el" href="group__devcalls.html#ga1eba5ef52c39e4c1d412e31cd03d4d2c">open()</a>, <a class="el" href="group__devcalls.html#ga743e9d7e0afd7a1eb0c4321e79bc30a3">read()</a>, <a class="el" href="group__devcalls.html#ga400d1061c614113f32fc30ce80c85a98">write()</a>, <a class="el" href="group__devcalls.html#ga24e6838ad3f08cdb319118280033a9d5">control()</a>, or <a class="el" href="group__devcalls.html#ga67013cfade639dcd90764203bfdb4656">close()</a> on it, each of which calls the corresponding function listed here. A UDP device essentially corresponds to a "socket" as used in other operating systems. Local and remote ports and addresses are specified in the <a class="el" href="group__devcalls.html#ga1eba5ef52c39e4c1d412e31cd03d4d2c">open()</a> calle. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gabcbf39c9ecabbf6066fff987c50c7db1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ushort udpAlloc </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate an available UDP device.</p>
<dl class="section return"><dt>Returns</dt><dd>Device number for a UDP device, or ::SYSERR if none are free. </dd></dl>

</div>
</div>
<a class="anchor" id="ga4b9a2995c6470acb368863cb0c467921"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpClose </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Closes a UDP device.</p>
<p>Caveat: There must not be any threads executing <a class="el" href="group__udpexternal.html#gaf42df1179176ea560a6101b7741cfe1d">udpWrite()</a> on the UDP device when it is closed. On the other hand, it is safe to close the UDP device while threads are executing <a class="el" href="group__udpexternal.html#gadab18aa82e8854f5a53051ab0ed2c665">udpRead()</a>, and they will return ::SYSERR. However, you still must not re-open the UDP device before all <a class="el" href="group__udpexternal.html#gadab18aa82e8854f5a53051ab0ed2c665">udpRead()</a> threads have returned.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>Device entry for the UDP device. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK if the UDP device was closed successfully; ::SYSERR otherwise. Currently this function can only fail if the UDP device was not actually open. </dd></dl>

</div>
</div>
<a class="anchor" id="ga19a687321da86a127c08eb51ed7d3b0a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpControl </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>arg1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long&#160;</td>
          <td class="paramname"><em>arg2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Control function for udp devices. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>udp device table entry </td></tr>
    <tr><td class="paramname">func</td><td>control function to execute </td></tr>
    <tr><td class="paramname">arg1</td><td>first argument for the control function </td></tr>
    <tr><td class="paramname">arg2</td><td>second argument for the control function </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>the result of the control function </dd></dl>

</div>
</div>
<a class="anchor" id="gae5b3e1ee3e3d286f70482aa26831af45"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpInit </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Set aside some space for a UDP device to be opened on </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>UDP device table entry </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK </dd></dl>

</div>
</div>
<a class="anchor" id="ga145b34934ec681c09c5d32083c7f769d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpOpen </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">va_list&#160;</td>
          <td class="paramname"><em>ap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Associate a UDP socket with local and remote IP addresses and ports, and prepare it for receiving and sending data with <a class="el" href="group__udpexternal.html#gadab18aa82e8854f5a53051ab0ed2c665">udpRead()</a> and <a class="el" href="group__udpexternal.html#gaf42df1179176ea560a6101b7741cfe1d">udpWrite()</a>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>Device table entry for the UDP device.</td></tr>
    <tr><td class="paramname">ap</td><td>Four additional arguments, specifying the following in order:<ul>
<li>The local IP address.</li>
<li>The remote IP address. May be <code>NULL</code> to create an initially unbound socket.</li>
<li>The local port. May be 0 to auto-assign a port number.</li>
<li>The remote port. May be 0 if creating an initially unbound socket.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>::OK if the UDP device was opened successfully; otherwise ::SYSERR. </dd></dl>

</div>
</div>
<a class="anchor" id="gadab18aa82e8854f5a53051ab0ed2c665"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpRead </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read the next UDP packet from a UDP device and place its data into the provided buffer.</p>
<p>In the default mode, the resulting data will be the UDP payload. If instead the UDP is in passive mode, the resulting data will be the UDP pseudo-header, directly followed by the UDP header, directly followed by the UDP payload.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>Device table entry for the UDP device. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer into which to read the data. </td></tr>
    <tr><td class="paramname">len</td><td>Maximum amount of data to read (length of <code>buf</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>On success, returns the number of bytes read. This is normally the size of the UDP packet (see note about passive mode above), but as special cases it will be 0 if the UDP is in non-blocking mode and no packets are available, or it will be <code>len</code> if the actual amount of data that was available was greater than <code>len</code>. Alternatively, if the UDP device was not initially open or was closed while attempting to read a packet, ::SYSERR is returned. </dd></dl>

</div>
</div>
<a class="anchor" id="gaf42df1179176ea560a6101b7741cfe1d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">devcall udpWrite </td>
          <td>(</td>
          <td class="paramtype">device *&#160;</td>
          <td class="paramname"><em>devptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write data to a UDP device, thereby sending it over the network in one or more UDP packets using the address/port parameters with which the UDP device is configured.</p>
<p>Note: depending on the lower levels of the network stack, this function likely only buffers the UDP packet(s) to be sent at some later time. Therefore, they may not have actually been transmitted on the wire when this function returns.</p>
<p>The UDP device MUST be open and MUST remain open throughout the execution of this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devptr</td><td>Device entry for the UDP device. </td></tr>
    <tr><td class="paramname">buf</td><td>Buffer of data to be sent. If the UDP device is in the default mode, this is interpreted as the UDP payload to send, which will be split up among multiple UDP packets if its size exceeds ::UDP_MAX_DATALEN bytes. Alternatively, if the UDP device is in passive mode", the data is intepreted as a single UDP packet including the UDP pseudo-header, followed by the UDP header, followed by the UDP payload. </td></tr>
    <tr><td class="paramname">len</td><td>Number of bytes of data to send (length of <code>buf</code>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>If any packets were successfully sent, returns the number of bytes of data successfully sent, which may be less than <code>len</code> in the case of an error. If the UDP device is not in passive mode and <code>len</code> was 0, no packets will be sent and 0 will be returned. Otherwise, returns ::SYSERR. </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.5
</small></address>
</body>
</html>
